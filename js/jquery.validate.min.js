/**
 * jQuery Form Validation
 *
 * @author Tom Bertrand
 * @version 1.0.0 (2014-05-22)
 *
 * @copyright
 * Copyright (C) 2014 Tom Bertrand.
 *
 * @link
 * http://www.runningcoder.org/jqueryvalidation/
 *
 * @license
 * Licensed under the MIT license.
 */
!function(window,document,$,undefined){window.Validation={};var _rules={NOTEMPTY:/./,NUMERIC:/^[0-9]+$/,MIXED:/^[\w\s-]+$/,NOSPACE:/^[^\s]+$/,TRIM:/^[^\s].*[^\s]$/,DATE:/^\d{4}-\d{2}-\d{2}(\s\d{2}:\d{2}(:\d{2})?)?$/,EMAIL:/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i,URL:/^(https?:\/\/)?((([a-z0-9]-*)*[a-z0-9]+\.?)*([a-z0-9]+))(\/[\w?=\.-]*)*$/,PHONE:/^(\()?\d{3}(\))?(-|\s)?\d{3}(-|\s)\d{4}$/,OPTIONAL:/^.*$/,COMPARISON:/^\s*([LV])\s*([<>]=?|==|!=)\s*([^<>=!]+?)\s*$/},_message={"default":"$ contain error(s).",NOTEMPTY:"$ must not be empty.",NUMERIC:"$ must be numeric.",STRING:"$ must be a string.",NOSPACE:"$ must not contain spaces.",TRIM:"$ must not start or end with space character.",MIXED:"$ must be letters or numbers (no special characters).",DATE:"$ is not a valid with format YYYY-MM-DD.",EMAIL:"$ is not valid.",URL:"$ is not valid.",PHONE:"$ is not a valid phone number","<":"$ must be less than % characters.","<=":"$ must be less or equal to % characters.",">":"$ must be greater than % characters.",">=":"$ must be greater or equal to % characters.","==":"$ must be equal to %","!=":"$ must be different than %"},_data={validation:"data-validation",validationMessage:"data-validation-message",regex:"data-validation-regex",regexMessage:"data-validation-regex-message",validationGroup:"data-validation-group",errorList:"data-error-list"},_options={submit:{settings:{form:null,display:"inline",insertion:"append",allErrors:!1,trigger:"click",button:"input[type='submit']",errorClass:"error",errorListClass:"error-list",inputContainer:null,clear:"focusin"},callback:{onInit:null,onValidate:null,onError:null,onBeforeSubmit:null,onSubmit:null,onAfterSubmit:null}},dynamic:{settings:{trigger:null,delay:300},callback:{onSuccess:null,onError:null,onComplete:null}}},_supported={submit:{settings:{display:["inline","block"],insertion:["append","prepend"],allErrors:[!0,!1],clear:["focusin","keypress",!1],trigger:["click","dblclick","focusout","hover","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","toggle"]}},dynamic:{settings:{trigger:["focusout","keydown","keypress","keyup"]}}};"function"!=typeof Object.preventExtensions&&(Object.preventExtensions=function(a){return a});var Validation=function(node,options){function extendOptions(){options instanceof Object||(options={});var a=Object.preventExtensions($.extend(!0,{},_options));for(var b in options)if(options.hasOwnProperty(b)&&options[b]instanceof Object)for(var c in options[b])if(options[b].hasOwnProperty(c)&&options[b][c]instanceof Object){for(var d in options[b][c])options[b][c].hasOwnProperty(d)&&_supported[b]&&_supported[b][c]&&_supported[b][c][d]&&-1===$.inArray(options[b][c][d],_supported[b][c][d])&&(window.debug("Validation.extendOptions - Delete unsupported property - "+c+": {"+d.toString()+": "+options[b][c][d].toString()+"}"),delete options[b][c][d]);a[b]&&a[b][c]&&(a[b][c]=$.extend(Object.preventExtensions(a[b][c]),options[b][c]))}options=a}function delegateDynamicValidation(){return options.dynamic.settings.trigger?($.each($(node).find("["+_data.validation+"]:not([disabled]),["+_data.regex+"]:not([disabled])"),function(a,b){$(b).unbind(options.dynamic.settings.trigger).on(options.dynamic.settings.trigger,function(){var b=this;_typeWatch(function(){validateInput(b)?_executeCallback(options.dynamic.callback.onSuccess,[node,b]):(displayOneError(b.name),_executeCallback(options.dynamic.callback.onError,[node,b,errors[b.name]])),_executeCallback(options.dynamic.callback.onComplete,[node,b])},options.dynamic.settings.delay)})}),void 0):!1}function delegateValidation(){_executeCallback(options.submit.callback.onInit,[node]),$(node).on("submit",!1),$(node).find(options.submit.settings.button).unbind(options.submit.settings.trigger).on(options.submit.settings.trigger,function(a){return a.preventDefault(),resetErrors(),_executeCallback(options.submit.callback.onValidate,[node]),validateForm()?(_executeCallback(options.submit.callback.onBeforeSubmit,[node]),options.submit.callback.onSubmit?_executeCallback(options.submit.callback.onSubmit,[node]):submitForm(),_executeCallback(options.submit.callback.onAfterSubmit,[node])):(_executeCallback(options.submit.callback.onError,[node,errors]),displayErrors()),!1})}function validateForm(){return $.each($(node).find("["+_data.validation+"]:not([disabled]),["+_data.regex+"]:not([disabled])"),function(a,b){validateInput(b)}),$.isEmptyObject(errors)}function validateInput(a){var b=$(a).attr("name");if(!b)return window.debug("Validation.validateInput - Invalid {string} inputName on "+a.toString()),!1;var c=_getInputValue(a),d=b.replace(/]$/,"").split(/]\[|[[\]]/g),e=d[d.length-1],f=$(a).attr(_data.validation),g=$(a).attr(_data.validationMessage),h=$(a).attr(_data.regex),i=$(a).attr(_data.regexMessage),j=!1;if(f&&(f=_api._splitValidation(f)),!$.isEmptyObject(f)){if(""===c&&-1!==$.inArray("OPTIONAL",f))return!0;$.each(f,function(a,d){if(j===!0)return!0;try{validateRule(c,d)}catch(f){g&&(j=!0),f[0]=g||f[0],registerError(b,f[0].replace("$",e).replace("%",f[1]))}})}if(h){var k=h.split("/");if(k.length>1){for(var l="",m=0;m<k.length-1;m++)""!==k[m]&&(l+=k[m]+"/");if(l=l.slice(0,-1),/[gimsxeU]+/.test(k[k.length-1]))var n=k[k.length-1];k=l}else k=k[0];try{var o=new RegExp(k,n)}catch(p){return window.debug("Invalid data-validation-regex on "+b),!0}try{validateRule(c,o)}catch(p){p[0]=i||p[0],registerError(b,p[0].replace("$",e))}}return $.isEmptyObject(errors[b])}function validateRule(value,rule){if(rule instanceof RegExp){if(rule.test(value))throw[_message["default"],""]}else if(_rules[rule]){if(!_rules[rule].test(value))throw[_message[rule],""]}else{var comparison=rule.match(_rules.COMPARISON);if(!comparison||4!==comparison.length)return window.debug("Validation.validateRule - Invalid validation rule: "+rule),void 0;var type=comparison[1],operator=comparison[2],compared=comparison[3],comparedValue;switch(type){case"L":if(isNaN(compared)){if(comparedValue=$(node).find('[name="'+compared+'"]').val(),!comparedValue)return window.debug('$.Validation.validateRule - Unable to find value of input[name="'+compared+'"] inside rule '+rule),!1;if(!eval('"'+encodeURIComponent(value)+'"'+operator+'"'+encodeURIComponent(comparedValue)+'"'))throw[_message[operator],compared]}else if(0==eval(value.length+operator+parseFloat(compared)))throw[_message[operator],compared];break;case"V":default:if(isNaN(compared)){if(comparedValue=$(node).find('[name="'+compared+'"]').val(),!comparedValue)return window.debug('$.Validation.validateRule - Unable to find value of input[name="'+compared+'"] inside rule '+rule),!1;if(!eval('"'+encodeURIComponent(value)+'"'+operator+'"'+encodeURIComponent(comparedValue)+'"'))throw[_message[operator],compared]}else if(!eval(value+operator+parseFloat(compared)))throw[_message[operator],compared]}}}function registerError(a,b){errors[a]||(errors[a]=[]),errors[a].push(b.capitalize())}function displayOneError(a){var b,c,d,e,g,h,f='<div class="'+options.submit.settings.errorListClass+'" '+_data.errorList+"><ul></ul></div>";if(!errors.hasOwnProperty(a))return!1;if(b=$(node).find('[name="'+a+'"]'),e=null,!b[0])return window.debug("Validation.displayOneError unable to find "+a),!1;g=b.attr(_data.validationGroup),g?(h=$(node).find('[name="'+a+'"]'),e=$(node).find('[id="'+g+'"]'),e[0]&&(e.addClass(options.submit.settings.errorClass),d=e)):(b.addClass(options.submit.settings.errorClass),options.submit.settings.inputContainer&&b.parentsUntil(node,options.submit.settings.inputContainer).addClass(options.submit.settings.errorClass),c=b.attr("id"),c&&(e=$(node).find('label[for="'+c+'"]')[0]),e||(e=b.parentsUntil(node,"label")[0]),e&&(e=$(e),e.addClass(options.submit.settings.errorClass))),"inline"===options.submit.settings.display?d=d||b.parent():"block"===options.submit.settings.display&&(d=$(node)),("inline"===options.submit.settings.display||"block"===options.submit.settings.display&&!d.find("["+_data.errorList+"]")[0])&&("append"===options.submit.settings.insertion?d.append(f):"prepend"===options.submit.settings.insertion&&d.prepend(f));for(var i=0;i<errors[a].length;i++)d.find("ul").append("<li>"+errors[a][i]+"</li>");(options.submit.settings.clear||options.dynamic.settings.trigger)&&(g&&h&&(b=h),b.unbind(options.submit.settings.clear).on(options.submit.settings.clear+" "+options.dynamic.settings.trigger,function(a,b,c,d,e){return function(){e?$(c).hasClass(options.submit.settings.errorClass)&&resetOneError(a,b,c,d,e):$(b).hasClass(options.submit.settings.errorClass)&&resetOneError(a,b,c,d)}}(a,b,e,d,g)))}function displayErrors(){for(var a in errors)displayOneError(a);"block"===options.submit.settings.display&&"function"==typeof $.scrollTo&&$.scrollTo(node,500,{offset:-100})}function resetOneError(a,b,c,d,e){try{delete errors[a]}catch(f){return window.debug("Validation.resetOneError unable to find and delete "+a+" inside {object} errors."),!1}options.submit.settings.inputContainer&&(e?c:b).parentsUntil(node,options.submit.settings.inputContainer).removeClass(options.submit.settings.errorClass),c.removeClass(options.submit.settings.errorClass),b.removeClass(options.submit.settings.errorClass),"inline"===options.submit.settings.display&&d.find("["+_data.errorList+"]").remove()}function resetErrors(){errors=[],$(node).find("["+_data.errorList+"]").remove(),$(node).find("."+options.submit.settings.errorClass).removeClass(options.submit.settings.errorClass)}function submitForm(){node.submit()}var errors=[],_typeWatch=function(){var a=0;return function(b,c){clearTimeout(a),a=setTimeout(b,c)}}(),_getInputValue=function(a){var b;switch($(a).attr("type")){case"checkbox":b=$(a).is(":checked")?1:"";break;case"radio":b=$(node).find('input[name="'+$(a).attr("name")+'"]:checked').val()||"";break;default:b=$(a).val()}return b},_executeCallback=function(a,b){if(!a)return!1;var c;if("function"==typeof a)c=a;else if("string"==typeof a||a instanceof Array){c=window,"string"==typeof a&&(a=[a,[]]);for(var d=a[0].split("."),e=a[1],f=!0,g=0;g<d.length;){if("undefined"==typeof c){f=!1;break}c=c[d[g++]]}if(!f||"function"!=typeof c)return window.debug("Validation._executeFunction - Invalid function - "+a[0].toString()),!1}return c.apply(this,$.merge(e||[],b?b:[])),!0};return this.__construct=function(){extendOptions(),delegateDynamicValidation(),delegateValidation()}(),{registerError:registerError,displayOneError:displayOneError,displayErrors:displayErrors}};$.fn.validate=$.validate=function(a){return _api.validate(this,a)},$.fn.addValidation=function(a){return _api.addValidation(this,a)},$.fn.removeValidation=function(a){return _api.removeValidation(this,a)},$.fn.addError=function(a){return _api.addError(this,a)};var _api={_formatValidation:function(a){return a=a.toString().replace(/\s/g,""),"["===a.charAt(0)&&"]"===a.charAt(a.length-1)&&(a=a.replace(/^\[|\]$/g,"")),a},_splitValidation:function(a){for(var c,b=this._formatValidation(a).split(","),d=0;d<b.length;d++)c=b[d],/^[a-z]+$/i.test(c)&&(b[d]=c.toUpperCase());return b},_joinValidation:function(a){return"["+a.join(", ")+"]"},validate:function(a,b){if("function"==typeof a){if(!b.submit.settings.form)return window.debug('$.validate - Undefined property "options.submit.settings.form" - Validation dropped.'),void 0;if(a=$(b.submit.settings.form),!a[0])return window.debug('$.validate - Unable to find jQuery form element "options.submit.settings.form" - '+b.submit.settings.form+" - Validation dropped."),void 0}else if("undefined"==typeof a[0])return window.debug('$("'+a.selector+'").validate() - Unable to find jQuery element - Validation dropped.'),void 0;return a.each(function(){window.Validation[a.selector]=new Validation(this,b)})},addValidation:function(a,b){var c=this;return b=c._splitValidation(b),b?a.each(function(){for(var f,a=$(this),d=a.attr(_data.validation),e=d&&d.length?c._splitValidation(d):[],g=0;g<b.length;g++)f=c._formatValidation(b[g]),-1===$.inArray(f,e)&&e.push(f);e.length&&a.attr(_data.validation,c._joinValidation(e))}):!1},removeValidation:function(a,b){var c=this;return b=c._splitValidation(b),b?a.each(function(){var f,g,a=$(this),d=a.attr(_data.validation),e=d&&d.length?c._splitValidation(d):[];if(!e.length)return a.removeAttr(_data.validation),!0;for(var h=0;h<b.length;h++)f=c._formatValidation(b[h]),g=$.inArray(f,e),-1!==g&&e.splice(g,1);return e.length?(a.attr(_data.validation,c._joinValidation(e)),void 0):(a.removeAttr(_data.validation),!0)}):!1},addError:function(a,b){if(!window.Validation[a.selector])return window.debug("$.addError - Invalid node selector - Make sure you are using the same one you initialize the Validation with."),!1;if("object"!=typeof b||$.isEmptyObject(b))return window.debug("$.addError - Invalid error object."),!1;for(var c in b)if(b.hasOwnProperty(c)){if("string"==typeof b[c])window.Validation[a.selector].registerError(c,b[c]);else{if(!(b[c]instanceof Array)){window.debug('$.addError - Invalid error object property - Accepted format: {"inputName": "errorString"} or {"inputName": ["errorString", "errorString"]}.');continue}for(var d=0;d<b[c].length;d++)window.Validation[a.selector].registerError(c,b[c][d])}window.Validation[a.selector].displayOneError(c)}}};window.debug=function(){this.console&&this.console.debug?this.console.debug("DEBUG: "+Array.prototype.slice.call(arguments)):window.log("DEBUG: "+Array.prototype.slice.call(arguments))},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)}}(window,document,window.jQuery);